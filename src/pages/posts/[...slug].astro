---
import { getCollection } from "astro:content";
import MarkdownPageLayout from "../../layouts/MarkdownPage.astro";

// Ensures Astro runs getStaticPaths() and builds static pages for all posts
export const prerender = true;

export async function getStaticPaths() {
	const allPosts = await getCollection("posts");

	// Return a path for every post file in src/content/posts/
	return allPosts.map((post) => ({
		params: { slug: post.slug },
		props: { post: post },
	}));
}

const { post } = Astro.props;
const { Content } = await post.render();

const pageTitle = post.data.title;
const pageDescription = post.data.description;
const publishDate = post.data.publishDate;
---

<MarkdownPageLayout frontmatter={{ ...post.data, title: pageTitle, description: pageDescription }}>
  <article class="py-10">
    <header class="mb-10 text-center">
      <h1 class="text-5xl font-extrabold mb-4">{pageTitle}</h1>
      
      <p class="text-lg text-gray-500">
        By <strong>{post.data.author}</strong> | Published on {publishDate.toLocaleDateString()}
      </p>
    </header>
    
    <Content /> 
    
  </article>
</MarkdownPageLayout>
