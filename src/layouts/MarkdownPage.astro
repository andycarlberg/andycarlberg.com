---
import Prose from "../components/Prose.astro";
import Layout from "./Layout.astro";

const { frontmatter } = Astro.props;
const { title, description, schemaData } = frontmatter;

let jsonLdSchema = null;

if (schemaData && schemaData.type === "Person") {
	const socialLinks = Object.values(schemaData.socialLinks || {});

	const siteBaseUrl = Astro.site;
	const canonicalUrl = new URL(Astro.url.pathname, siteBaseUrl);

	jsonLdSchema = {
		"@context": "https://schema.org",
		"@type": schemaData.type,
		name: "Andy Carlberg",
		url: canonicalUrl,
		image: new URL(schemaData.image, Astro.site).href,
		jobTitle: schemaData.jobTitle,
		alumniOf: schemaData.alumni.map((org) => ({
			"@type": "EducationalOrganization",
			name: org.name,
			sameAs: org.wikipedia,
		})),
		sameAs: socialLinks,
		disambiguatingDescription: description,
	};
}
---

<Layout 
    title={title} 
    description={description} 
    schema={jsonLdSchema} 
>
  <Prose class="mx-auto">
    <slot />
  </Prose>
</Layout>
